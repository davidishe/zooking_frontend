import { IdGenerator } from '../../../models/id-generator';
import { ContinueWith } from '../../../models/procedure/handler/contiue-with.model';
import { getViewportWidth } from '../get-viewport-width/get-viewport-width';
import { shuffleSlides } from './shuffle-slides';
/**
 * Moves slide from left side to right or vise versa
 * in order to balance weight or predict offset changes
 */
export function shuffleSlidesProcedure() {
    return ({ state, procedureState, environment }) => {
        var _a;
        const result = shuffleSlides(state.slides, state.offset, state.config.slideWidth, getViewportWidth(state), state.config.items, state.config.shouldLoop, state.config.threshold, (_a = environment === null || environment === void 0 ? void 0 : environment.slideIdGenerator) !== null && _a !== void 0 ? _a : new IdGenerator());
        state.slides = result.slides;
        state.activeSlideIndex = result.slides.findIndex((item) => item.options.isActive) || 0;
        if (typeof procedureState.offsetSnapshot !== 'undefined') {
            procedureState.offsetSnapshot = result.modifiedOffset - state.offset + procedureState.offsetSnapshot;
        }
        state.offset = result.modifiedOffset;
        return new ContinueWith(state);
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2h1ZmZsZS1zbGlkZXMtcHJvY2VkdXJlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvbmctY2Fyb3VzZWwvc3JjL2xpYi9wcml2YXRlL3NlcnZpY2UvaGVscGVycy9zaHVmZmxlLXNsaWRlcy9zaHVmZmxlLXNsaWRlcy1wcm9jZWR1cmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLDhCQUE4QixDQUFDO0FBQzNELE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxzREFBc0QsQ0FBQztBQUlwRixPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSwwQ0FBMEMsQ0FBQztBQUM1RSxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFFakQ7OztHQUdHO0FBQ0gsTUFBTSxVQUFVLHNCQUFzQjtJQUNsQyxPQUFPLENBQUMsRUFBQyxLQUFLLEVBQUUsY0FBYyxFQUFFLFdBQVcsRUFBdUIsRUFBb0IsRUFBRTs7UUFDcEYsTUFBTSxNQUFNLEdBQUcsYUFBYSxDQUN4QixLQUFLLENBQUMsTUFBTSxFQUNaLEtBQUssQ0FBQyxNQUFNLEVBQ1osS0FBSyxDQUFDLE1BQU0sQ0FBQyxVQUFVLEVBQ3ZCLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxFQUN2QixLQUFLLENBQUMsTUFBTSxDQUFDLEtBQUssRUFDbEIsS0FBSyxDQUFDLE1BQU0sQ0FBQyxVQUFVLEVBQ3ZCLEtBQUssQ0FBQyxNQUFNLENBQUMsU0FBUyxRQUN0QixXQUFXLGFBQVgsV0FBVyx1QkFBWCxXQUFXLENBQUUsZ0JBQWdCLG1DQUFJLElBQUksV0FBVyxFQUFFLENBQ3JELENBQUM7UUFDRixLQUFLLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUM7UUFDN0IsS0FBSyxDQUFDLGdCQUFnQixHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUMsSUFBbUIsRUFBRSxFQUFFLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDdEcsSUFBSSxPQUFPLGNBQWMsQ0FBQyxjQUFjLEtBQUssV0FBVyxFQUFFO1lBQ3RELGNBQWMsQ0FBQyxjQUFjLEdBQUcsTUFBTSxDQUFDLGNBQWMsR0FBRyxLQUFLLENBQUMsTUFBTSxHQUFHLGNBQWMsQ0FBQyxjQUFjLENBQUM7U0FDeEc7UUFDRCxLQUFLLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQyxjQUFjLENBQUM7UUFFckMsT0FBTyxJQUFJLFlBQVksQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUNuQyxDQUFDLENBQUM7QUFDTixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ2Fyb3VzZWxTbGlkZSB9IGZyb20gJy4uLy4uLy4uL21vZGVscy9jYXJvdXNlbC1zbGlkZSc7XG5pbXBvcnQgeyBJZEdlbmVyYXRvciB9IGZyb20gJy4uLy4uLy4uL21vZGVscy9pZC1nZW5lcmF0b3InO1xuaW1wb3J0IHsgQ29udGludWVXaXRoIH0gZnJvbSAnLi4vLi4vLi4vbW9kZWxzL3Byb2NlZHVyZS9oYW5kbGVyL2NvbnRpdWUtd2l0aC5tb2RlbCc7XG5pbXBvcnQgeyBQcm9jZWR1cmVIYW5kbGVyIH0gZnJvbSAnLi4vLi4vLi4vbW9kZWxzL3Byb2NlZHVyZS9oYW5kbGVyL3Byb2NlZHVyZS1oYW5kbGVyLmludGVyZmFjZSc7XG5pbXBvcnQgeyBQcm9jZWR1cmVTdGF0ZUZhY2FkZSB9IGZyb20gJy4uLy4uLy4uL21vZGVscy9wcm9jZWR1cmUvcHJvY2VkdXJlLXN0YXRlLWZhY2FkZS5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgUHJvY2VkdXJlIH0gZnJvbSAnLi4vLi4vLi4vbW9kZWxzL3Byb2NlZHVyZS9wcm9jZWR1cmUudHlwZSc7XG5pbXBvcnQgeyBnZXRWaWV3cG9ydFdpZHRoIH0gZnJvbSAnLi4vZ2V0LXZpZXdwb3J0LXdpZHRoL2dldC12aWV3cG9ydC13aWR0aCc7XG5pbXBvcnQgeyBzaHVmZmxlU2xpZGVzIH0gZnJvbSAnLi9zaHVmZmxlLXNsaWRlcyc7XG5cbi8qKlxuICogTW92ZXMgc2xpZGUgZnJvbSBsZWZ0IHNpZGUgdG8gcmlnaHQgb3IgdmlzZSB2ZXJzYVxuICogaW4gb3JkZXIgdG8gYmFsYW5jZSB3ZWlnaHQgb3IgcHJlZGljdCBvZmZzZXQgY2hhbmdlc1xuICovXG5leHBvcnQgZnVuY3Rpb24gc2h1ZmZsZVNsaWRlc1Byb2NlZHVyZSgpOiBQcm9jZWR1cmUge1xuICAgIHJldHVybiAoe3N0YXRlLCBwcm9jZWR1cmVTdGF0ZSwgZW52aXJvbm1lbnR9OiBQcm9jZWR1cmVTdGF0ZUZhY2FkZSk6IFByb2NlZHVyZUhhbmRsZXIgPT4ge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBzaHVmZmxlU2xpZGVzKFxuICAgICAgICAgICAgc3RhdGUuc2xpZGVzLFxuICAgICAgICAgICAgc3RhdGUub2Zmc2V0LFxuICAgICAgICAgICAgc3RhdGUuY29uZmlnLnNsaWRlV2lkdGgsXG4gICAgICAgICAgICBnZXRWaWV3cG9ydFdpZHRoKHN0YXRlKSxcbiAgICAgICAgICAgIHN0YXRlLmNvbmZpZy5pdGVtcyxcbiAgICAgICAgICAgIHN0YXRlLmNvbmZpZy5zaG91bGRMb29wLFxuICAgICAgICAgICAgc3RhdGUuY29uZmlnLnRocmVzaG9sZCxcbiAgICAgICAgICAgIGVudmlyb25tZW50Py5zbGlkZUlkR2VuZXJhdG9yID8/IG5ldyBJZEdlbmVyYXRvcigpLFxuICAgICAgICApO1xuICAgICAgICBzdGF0ZS5zbGlkZXMgPSByZXN1bHQuc2xpZGVzO1xuICAgICAgICBzdGF0ZS5hY3RpdmVTbGlkZUluZGV4ID0gcmVzdWx0LnNsaWRlcy5maW5kSW5kZXgoKGl0ZW06IENhcm91c2VsU2xpZGUpID0+IGl0ZW0ub3B0aW9ucy5pc0FjdGl2ZSkgfHwgMDtcbiAgICAgICAgaWYgKHR5cGVvZiBwcm9jZWR1cmVTdGF0ZS5vZmZzZXRTbmFwc2hvdCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIHByb2NlZHVyZVN0YXRlLm9mZnNldFNuYXBzaG90ID0gcmVzdWx0Lm1vZGlmaWVkT2Zmc2V0IC0gc3RhdGUub2Zmc2V0ICsgcHJvY2VkdXJlU3RhdGUub2Zmc2V0U25hcHNob3Q7XG4gICAgICAgIH1cbiAgICAgICAgc3RhdGUub2Zmc2V0ID0gcmVzdWx0Lm1vZGlmaWVkT2Zmc2V0O1xuXG4gICAgICAgIHJldHVybiBuZXcgQ29udGludWVXaXRoKHN0YXRlKTtcbiAgICB9O1xufVxuIl19