/**
 * @fileoverview added by tsickle
 * Generated from: lib/ng2-carouselamos.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, Output, EventEmitter, TemplateRef, ViewChild, ElementRef } from "@angular/core";
import isEqual from "lodash.isequal";
/**
 * @record
 */
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '@angular/common';

var _c0 = ["list"];
var _c1 = ["ng2-carouselamos", ""];
function Ng2CarouselamosComponent_4_ng_template_0_Template(rf, ctx) { }
var _c2 = function (a0, a1, a2) { return { $implicit: a0, index: a1, selectedIndex: a2 }; };
function Ng2CarouselamosComponent_4_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, Ng2CarouselamosComponent_4_ng_template_0_Template, 0, 0, "ng-template", 6);
} if (rf & 2) {
    var item_r3 = ctx.$implicit;
    var i_r4 = ctx.index;
    var ctx_r1 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r1.$item)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction3(2, _c2, item_r3, i_r4, ctx_r1.childIndex));
} }
function Ng2CarouselamosComponent_div_5_button_1_ng_template_1_Template(rf, ctx) { }
function Ng2CarouselamosComponent_div_5_button_1_Template(rf, ctx) { if (rf & 1) {
    var _r10 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "button", 9);
    ɵngcc0.ɵɵlistener("click", function Ng2CarouselamosComponent_div_5_button_1_Template_button_click_0_listener() { ɵngcc0.ɵɵrestoreView(_r10); var ctx_r9 = ɵngcc0.ɵɵnextContext(2); var _r0 = ɵngcc0.ɵɵreference(3); return ctx_r9.scroll(false, _r0); });
    ɵngcc0.ɵɵtemplate(1, Ng2CarouselamosComponent_div_5_button_1_ng_template_1_Template, 0, 0, "ng-template", 10);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    var ctx_r6 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("disabled", ctx_r6.amount >= 0);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r6.$prev);
} }
function Ng2CarouselamosComponent_div_5_button_2_ng_template_1_Template(rf, ctx) { }
function Ng2CarouselamosComponent_div_5_button_2_Template(rf, ctx) { if (rf & 1) {
    var _r13 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "button", 9);
    ɵngcc0.ɵɵlistener("click", function Ng2CarouselamosComponent_div_5_button_2_Template_button_click_0_listener() { ɵngcc0.ɵɵrestoreView(_r13); var ctx_r12 = ɵngcc0.ɵɵnextContext(2); var _r0 = ɵngcc0.ɵɵreference(3); return ctx_r12.scroll(true, _r0); });
    ɵngcc0.ɵɵtemplate(1, Ng2CarouselamosComponent_div_5_button_2_ng_template_1_Template, 0, 0, "ng-template", 10);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    var ctx_r7 = ɵngcc0.ɵɵnextContext(2);
    var _r0 = ɵngcc0.ɵɵreference(3);
    ɵngcc0.ɵɵproperty("disabled", ctx_r7.amount <= -(_r0.scrollWidth - ctx_r7.width));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r7.$next);
} }
function Ng2CarouselamosComponent_div_5_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div", 7);
    ɵngcc0.ɵɵtemplate(1, Ng2CarouselamosComponent_div_5_button_1_Template, 2, 2, "button", 8);
    ɵngcc0.ɵɵtemplate(2, Ng2CarouselamosComponent_div_5_button_2_Template, 2, 2, "button", 8);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    var ctx_r2 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r2.$prev);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r2.$next);
} }
export function SelectedItemInterface() { }
if (false) {
    /** @type {?} */
    SelectedItemInterface.prototype.item;
    /** @type {?} */
    SelectedItemInterface.prototype.index;
    /** @type {?} */
    SelectedItemInterface.prototype.first;
}
var Ng2CarouselamosComponent = /** @class */ (function () {
    function Ng2CarouselamosComponent() {
        this.childIndex = 0;
        this.amount = 0;
        this.startPress = 0;
        this.lastX = 0;
        this.startAt = 0;
        this.items = [];
        this.width = 500;
        this.onSelectedItem = new EventEmitter();
    }
    /**
     * @param {?} e
     * @return {?}
     */
    Ng2CarouselamosComponent.prototype.onMousedown = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        if (e.which === 1) {
            this.startPress = e.clientX;
            this.lastX = this.amount;
        }
    };
    /**
     * @param {?} e
     * @return {?}
     */
    Ng2CarouselamosComponent.prototype.onTouchdown = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        if (navigator.userAgent.indexOf("Android") >= 0)
            e.preventDefault();
        this.startPress = e.targetTouches[0].clientX;
        this.lastX = this.amount;
    };
    /**
     * @param {?} e
     * @param {?} maxWidth
     * @return {?}
     */
    Ng2CarouselamosComponent.prototype.onMousemove = /**
     * @param {?} e
     * @param {?} maxWidth
     * @return {?}
     */
    function (e, maxWidth) {
        if (e.which === 1) {
            /** @type {?} */
            var amount = this.lastX - (this.startPress - e.clientX);
            if (amount > 0 || amount < -(maxWidth - this.width))
                return;
            this.amount = amount;
        }
    };
    /**
     * @param {?} e
     * @param {?} maxWidth
     * @return {?}
     */
    Ng2CarouselamosComponent.prototype.onTouchmove = /**
     * @param {?} e
     * @param {?} maxWidth
     * @return {?}
     */
    function (e, maxWidth) {
        if (navigator.userAgent.indexOf("Android") >= 0)
            e.preventDefault();
        /** @type {?} */
        var amount = this.lastX - (this.startPress - e.targetTouches[0].clientX);
        if (amount > 0 || amount < -(maxWidth - this.width))
            return;
        this.amount = amount;
    };
    /**
     * @param {?} e
     * @param {?} elem
     * @return {?}
     */
    Ng2CarouselamosComponent.prototype.onMouseup = /**
     * @param {?} e
     * @param {?} elem
     * @return {?}
     */
    function (e, elem) {
        if (e.which === 1) {
            this.startPress = 0;
            this.snap(elem);
        }
    };
    /**
     * @param {?} e
     * @param {?} elem
     * @return {?}
     */
    Ng2CarouselamosComponent.prototype.onTouchup = /**
     * @param {?} e
     * @param {?} elem
     * @return {?}
     */
    function (e, elem) {
        if (navigator.userAgent.indexOf("Android") >= 0)
            e.preventDefault();
        this.startPress = 0;
        this.snap(elem);
    };
    /**
     * @param {?} elem
     * @return {?}
     */
    Ng2CarouselamosComponent.prototype.snap = /**
     * @param {?} elem
     * @return {?}
     */
    function (elem) {
        /** @type {?} */
        var counter = 0;
        /** @type {?} */
        var lastVal = 0;
        for (var i = 0; i < this.items.length; i++) {
            /** @type {?} */
            var el = elem.children[i];
            /** @type {?} */
            var style = el.currentStyle || window.getComputedStyle(el);
            counter +=
                el.offsetWidth +
                    (parseFloat(style.marginLeft) + parseFloat(style.marginRight));
            if (this.amount <= lastVal && this.amount >= -counter) {
                this.amount = -lastVal;
                this.childIndex = i;
                this.onSelectedItem.emit({
                    item: this.items[this.childIndex],
                    index: this.childIndex,
                    first: false
                });
                return;
            }
            lastVal = counter;
        }
        return counter;
    };
    /**
     * @param {?} forward
     * @param {?} elem
     * @param {?=} qty
     * @return {?}
     */
    Ng2CarouselamosComponent.prototype.scroll = /**
     * @param {?} forward
     * @param {?} elem
     * @param {?=} qty
     * @return {?}
     */
    function (forward, elem, qty) {
        if (qty === void 0) { qty = 1; }
        this.childIndex += forward ? qty : -qty;
        this.onSelectedItem.emit({
            item: this.items[this.childIndex],
            index: this.childIndex,
            first: false
        });
        this.amount = -this.calcScroll(elem);
    };
    /**
     * @param {?} elem
     * @return {?}
     */
    Ng2CarouselamosComponent.prototype.calcScroll = /**
     * @param {?} elem
     * @return {?}
     */
    function (elem) {
        /** @type {?} */
        var counter = 0;
        for (var i = this.childIndex - 1; i >= 0; i--) {
            /** @type {?} */
            var el = elem.children[i];
            /** @type {?} */
            var style = el.currentStyle || window.getComputedStyle(el);
            counter +=
                el.offsetWidth +
                    (parseFloat(style.marginLeft) + parseFloat(style.marginRight));
        }
        return counter;
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    Ng2CarouselamosComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        if (changes.items &&
            !isEqual(changes.items.previousValue, changes.items.currentValue)) {
            if (changes.items.firstChange) {
                this.onSelectedItem.emit({
                    item: this.items[this.childIndex],
                    index: this.childIndex,
                    first: true
                });
            }
            this.amount = 0;
        }
    };
    /**
     * @return {?}
     */
    Ng2CarouselamosComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.startPress = 1;
        this.scroll(true, this.list.nativeElement, this.startAt);
        setTimeout((/**
         * @return {?}
         */
        function () { return (_this.startPress = 0); }));
    };
    Ng2CarouselamosComponent.propDecorators = {
        startAt: [{ type: Input }],
        items: [{ type: Input }],
        width: [{ type: Input }],
        $prev: [{ type: Input }],
        $next: [{ type: Input }],
        $item: [{ type: Input }],
        onSelectedItem: [{ type: Output }],
        list: [{ type: ViewChild, args: ["list", { static: true },] }]
    };
Ng2CarouselamosComponent.ɵfac = function Ng2CarouselamosComponent_Factory(t) { return new (t || Ng2CarouselamosComponent)(); };
Ng2CarouselamosComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: Ng2CarouselamosComponent, selectors: [["", "ng2-carouselamos", ""]], viewQuery: function Ng2CarouselamosComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵstaticViewQuery(_c0, true);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.list = _t.first);
    } }, inputs: { startAt: "startAt", items: "items", width: "width", $prev: "$prev", $next: "$next", $item: "$item" }, outputs: { onSelectedItem: "onSelectedItem" }, features: [ɵngcc0.ɵɵNgOnChangesFeature], attrs: _c1, decls: 6, vars: 13, consts: [[1, "ng2-carouselamos-container"], [1, "ng2-carouselamos-wrapper", 3, "mousedown", "touchstart", "mousemove", "touchmove", "mouseup", "mouseleave", "touchend"], [1, "ng2-carouselamos"], ["list", ""], [4, "ngFor", "ngForOf"], ["class", "controls", 4, "ngIf"], [3, "ngTemplateOutlet", "ngTemplateOutletContext"], [1, "controls"], ["type", "button", 3, "disabled", "click", 4, "ngIf"], ["type", "button", 3, "disabled", "click"], [3, "ngTemplateOutlet"]], template: function Ng2CarouselamosComponent_Template(rf, ctx) { if (rf & 1) {
        var _r14 = ɵngcc0.ɵɵgetCurrentView();
        ɵngcc0.ɵɵelementStart(0, "div", 0);
        ɵngcc0.ɵɵelementStart(1, "div", 1);
        ɵngcc0.ɵɵlistener("mousedown", function Ng2CarouselamosComponent_Template_div_mousedown_1_listener($event) { return ctx.onMousedown($event); })("touchstart", function Ng2CarouselamosComponent_Template_div_touchstart_1_listener($event) { return ctx.onTouchdown($event); })("mousemove", function Ng2CarouselamosComponent_Template_div_mousemove_1_listener($event) { ɵngcc0.ɵɵrestoreView(_r14); var _r0 = ɵngcc0.ɵɵreference(3); return ctx.onMousemove($event, _r0.scrollWidth); })("touchmove", function Ng2CarouselamosComponent_Template_div_touchmove_1_listener($event) { ɵngcc0.ɵɵrestoreView(_r14); var _r0 = ɵngcc0.ɵɵreference(3); return ctx.onTouchmove($event, _r0.scrollWidth); })("mouseup", function Ng2CarouselamosComponent_Template_div_mouseup_1_listener($event) { ɵngcc0.ɵɵrestoreView(_r14); var _r0 = ɵngcc0.ɵɵreference(3); return ctx.onMouseup($event, _r0); })("mouseleave", function Ng2CarouselamosComponent_Template_div_mouseleave_1_listener($event) { ɵngcc0.ɵɵrestoreView(_r14); var _r0 = ɵngcc0.ɵɵreference(3); return ctx.onMouseup($event, _r0); })("touchend", function Ng2CarouselamosComponent_Template_div_touchend_1_listener($event) { ɵngcc0.ɵɵrestoreView(_r14); var _r0 = ɵngcc0.ɵɵreference(3); return ctx.onTouchup($event, _r0); });
        ɵngcc0.ɵɵelementStart(2, "div", 2, 3);
        ɵngcc0.ɵɵtemplate(4, Ng2CarouselamosComponent_4_Template, 1, 6, undefined, 4);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵtemplate(5, Ng2CarouselamosComponent_div_5_Template, 3, 2, "div", 5);
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵstyleProp("width", ctx.width + "px");
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵstyleProp("transition", ctx.startPress > 0 ? "none" : "-webkit-transform 1s")("webkit-transition", ctx.startPress > 0 ? "none" : "-webkit-transform 1s")("transform", "translateX(" + ctx.amount + "px)")("webkit-transform", "translateX(" + ctx.amount + "px)");
        ɵngcc0.ɵɵattribute("startPress", ctx.startPress);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("ngForOf", ctx.items);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.$prev || ctx.$next);
    } }, directives: [ɵngcc1.NgForOf, ɵngcc1.NgIf, ɵngcc1.NgTemplateOutlet], styles: [".ng2-carouselamos-container[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center}.ng2-carouselamos-wrapper[_ngcontent-%COMP%]{overflow:hidden}.ng2-carouselamos[_ngcontent-%COMP%]{display:flex;transition:transform 1s}.controls[_ngcontent-%COMP%]{pointer-events:none;position:absolute;display:flex;width:100%;justify-content:space-between;top:50%;left:0;transform:translateY(-50%)}.controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{pointer-events:all;background:0 0;border:0}"] });
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(Ng2CarouselamosComponent, [{
        type: Component,
        args: [{
                selector: "[ng2-carouselamos]",
                template: "<div class=\"ng2-carouselamos-container\">\n  <div\n    class=\"ng2-carouselamos-wrapper\"\n    [style.width]=\"width + 'px'\"\n    (mousedown)=\"onMousedown($event)\"\n    (touchstart)=\"onTouchdown($event)\"\n    (mousemove)=\"onMousemove($event, list.scrollWidth)\"\n    (touchmove)=\"onTouchmove($event, list.scrollWidth)\"\n    (mouseup)=\"onMouseup($event, list)\"\n    (mouseleave)=\"onMouseup($event, list)\"\n    (touchend)=\"onTouchup($event, list)\"\n  >\n    <div\n      class=\"ng2-carouselamos\"\n      [attr.startPress]=\"startPress\"\n      [style.transition]=\"startPress > 0 ? 'none' : '-webkit-transform 1s'\"\n      [style.webkitTransition]=\"\n        startPress > 0 ? 'none' : '-webkit-transform 1s'\n      \"\n      [style.transform]=\"'translateX(' + amount + 'px)'\"\n      [style.webkitTransform]=\"'translateX(' + amount + 'px)'\"\n      #list\n    >\n      <ng-template\n        *ngFor=\"let item of items; let i = index\"\n        [ngTemplateOutlet]=\"$item\"\n        [ngTemplateOutletContext]=\"{\n          $implicit: item,\n          index: i,\n          selectedIndex: childIndex\n        }\"\n      ></ng-template>\n    </div>\n  </div>\n  <div class=\"controls\" *ngIf=\"$prev || $next\">\n    <button\n      type=\"button\"\n      *ngIf=\"$prev\"\n      (click)=\"scroll(false, list)\"\n      [disabled]=\"amount >= 0\"\n    >\n      <ng-template [ngTemplateOutlet]=\"$prev\"></ng-template>\n    </button>\n    <button\n      type=\"button\"\n      *ngIf=\"$next\"\n      (click)=\"scroll(true, list)\"\n      [disabled]=\"amount <= -(list.scrollWidth - width)\"\n    >\n      <ng-template [ngTemplateOutlet]=\"$next\"></ng-template>\n    </button>\n  </div>\n</div>\n",
                styles: [".ng2-carouselamos-container{position:relative;display:flex;justify-content:center}.ng2-carouselamos-wrapper{overflow:hidden}.ng2-carouselamos{display:flex;transition:transform 1s}.controls{pointer-events:none;position:absolute;display:flex;width:100%;justify-content:space-between;top:50%;left:0;transform:translateY(-50%)}.controls button{pointer-events:all;background:0 0;border:0}"]
            }]
    }], function () { return []; }, { startAt: [{
            type: Input
        }], items: [{
            type: Input
        }], width: [{
            type: Input
        }], onSelectedItem: [{
            type: Output
        }], $prev: [{
            type: Input
        }], $next: [{
            type: Input
        }], $item: [{
            type: Input
        }], list: [{
            type: ViewChild,
            args: ["list", { static: true }]
        }] }); })();
    return Ng2CarouselamosComponent;
}());
export { Ng2CarouselamosComponent };
if (false) {
    /** @type {?} */
    Ng2CarouselamosComponent.prototype.childIndex;
    /** @type {?} */
    Ng2CarouselamosComponent.prototype.amount;
    /** @type {?} */
    Ng2CarouselamosComponent.prototype.startPress;
    /** @type {?} */
    Ng2CarouselamosComponent.prototype.lastX;
    /** @type {?} */
    Ng2CarouselamosComponent.prototype.startAt;
    /** @type {?} */
    Ng2CarouselamosComponent.prototype.items;
    /** @type {?} */
    Ng2CarouselamosComponent.prototype.width;
    /** @type {?} */
    Ng2CarouselamosComponent.prototype.$prev;
    /** @type {?} */
    Ng2CarouselamosComponent.prototype.$next;
    /** @type {?} */
    Ng2CarouselamosComponent.prototype.$item;
    /** @type {?} */
    Ng2CarouselamosComponent.prototype.onSelectedItem;
    /** @type {?} */
    Ng2CarouselamosComponent.prototype.list;
}

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmcyLWNhcm91c2VsYW1vcy5jb21wb25lbnQuanMiLCJzb3VyY2VzIjpbIm5nMi1jYXJvdXNlbGFtb3MvbGliL25nMi1jYXJvdXNlbGFtb3MuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUNMLFNBQVMsRUFDVCxLQUFLLEVBQ0wsTUFBTSxFQUNOLFlBQVksRUFDWixXQUFXLEVBRVgsU0FBUyxFQUNULFVBQVUsRUFFWCxNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLE9BQU8sTUFBTSxnQkFBZ0IsQ0FBQztBQUNyQztBQUNHO0FBQVc7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBZCwyQ0FJQztBQUNEO0FBQ1k7QUFDUSxJQU5sQixxQ0FBVTtBQUNaO0FBQ0ksSUFERixzQ0FBYztBQUNoQjtBQUdBLElBSEUsc0NBQWU7QUFDakI7QUFFQTtBQUVhLElBRmI7QUFDeUIsUUFjdkIsZUFBVSxHQUFXLENBQUMsQ0FBQztBQUN6QixRQUFFLFdBQU0sR0FBVyxDQUFDLENBQUM7QUFDckIsUUFBRSxlQUFVLEdBQVcsQ0FBQyxDQUFDO0FBQ3pCLFFBQUUsVUFBSyxHQUFXLENBQUMsQ0FBQztBQUNwQixRQUVFLFlBQU8sR0FBRyxDQUFDLENBQUM7QUFDZCxRQUVFLFVBQUssR0FBZSxFQUFFLENBQUM7QUFDekIsUUFFRSxVQUFLLEdBQVcsR0FBRyxDQUFDO0FBQ3RCLFFBV0UsbUJBQWMsR0FBd0MsSUFBSSxZQUFZLEVBQUUsQ0FBQztBQUMzRSxJQThHQSxDQUFDO0FBQ0Q7QUFBUTtBQUFvQjtBQUFtQjtBQUFRLElBM0dyRCw4Q0FBVztBQUFPO0FBQ1g7QUFDTjtBQUFRLElBRlQsVUFBWSxDQUFhO0FBQzNCLFFBQUksSUFBSSxDQUFDLENBQUMsS0FBSyxLQUFLLENBQUMsRUFBRTtBQUN2QixZQUFNLElBQUksQ0FBQyxVQUFVLEdBQUcsQ0FBQyxDQUFDLE9BQU8sQ0FBQztB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ICBFdmVudEVtaXR0ZXIsXG4gIFRlbXBsYXRlUmVmLFxuICBTaW1wbGVDaGFuZ2VzLFxuICBWaWV3Q2hpbGQsXG4gIEVsZW1lbnRSZWYsXG4gIEFmdGVyVmlld0luaXRcbn0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcbmltcG9ydCBpc0VxdWFsIGZyb20gXCJsb2Rhc2guaXNlcXVhbFwiO1xuXG5leHBvcnQgaW50ZXJmYWNlIFNlbGVjdGVkSXRlbUludGVyZmFjZSB7XG4gIGl0ZW06IGFueTtcbiAgaW5kZXg6IG51bWJlcjtcbiAgZmlyc3Q6IGJvb2xlYW47XG59XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogXCJbbmcyLWNhcm91c2VsYW1vc11cIixcbiAgc3R5bGVVcmxzOiBbXCIuL25nMi1jYXJvdXNlbGFtb3MuY29tcG9uZW50LnNjc3NcIl0sXG4gIHRlbXBsYXRlVXJsOiBcIi4vbmcyLWNhcm91c2VsYW1vcy5jb21wb25lbnQuaHRtbFwiXG59KVxuLypcbiAqXG4gKiBAcGFyYW0oKSBzdGFydEF0IC0gaW5kZXggb2Ygc2xpZGUgdG8gcmVuZGVyIGZpcnN0LiBEZWZhdWx0IHRvIDAuXG4gKiBAcGFyYW0oKSBpdGVtcyAtIExpc3Qgb2YgaXRlbXMgdG8gYmVsb25nIGluIGNhcm91c2VsXG4gKiBAcGFyYW0oKSB3aWR0aCAtIFNpemUgb2Ygd2luZG93KHZpZXcpIHRvIHNob3dcbiAqIEBwYXJhbSgpICRwcmV2IC0gVGVtcGxhdGUgZm9yIHByZXZpb3VzIGJ1dHRvblxuICogQHBhcmFtKCkgJG5leHQgLSBUZW1wbGF0ZSBmb3IgbmV4dCBidXR0b25cbiAqIEBwYXJhbSgpICRpdGVtIC0gVGVtcGxhdGUgZm9yIHRoZSBpdGVtXG4gKi9cbmV4cG9ydCBjbGFzcyBOZzJDYXJvdXNlbGFtb3NDb21wb25lbnQgaW1wbGVtZW50cyBBZnRlclZpZXdJbml0IHtcbiAgY2hpbGRJbmRleDogbnVtYmVyID0gMDtcbiAgYW1vdW50OiBudW1iZXIgPSAwO1xuICBzdGFydFByZXNzOiBudW1iZXIgPSAwO1xuICBsYXN0WDogbnVtYmVyID0gMDtcblxuICBASW5wdXQoKVxuICBzdGFydEF0ID0gMDtcblxuICBASW5wdXQoKVxuICBpdGVtczogQXJyYXk8YW55PiA9IFtdO1xuXG4gIEBJbnB1dCgpXG4gIHdpZHRoOiBudW1iZXIgPSA1MDA7XG5cbiAgQElucHV0KClcbiAgJHByZXY6IFRlbXBsYXRlUmVmPGFueT47XG5cbiAgQElucHV0KClcbiAgJG5leHQ6IFRlbXBsYXRlUmVmPGFueT47XG5cbiAgQElucHV0KClcbiAgJGl0ZW06IFRlbXBsYXRlUmVmPGFueT47XG5cbiAgQE91dHB1dCgpXG4gIG9uU2VsZWN0ZWRJdGVtOiBFdmVudEVtaXR0ZXI8U2VsZWN0ZWRJdGVtSW50ZXJmYWNlPiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcblxuICBAVmlld0NoaWxkKFwibGlzdFwiLCB7IHN0YXRpYzogdHJ1ZSB9KVxuICBsaXN0OiBFbGVtZW50UmVmO1xuXG4gIG9uTW91c2Vkb3duKGU6IE1vdXNlRXZlbnQpIHtcbiAgICBpZiAoZS53aGljaCA9PT0gMSkge1xuICAgICAgdGhpcy5zdGFydFByZXNzID0gZS5jbGllbnRYO1xuICAgICAgdGhpcy5sYXN0WCA9IHRoaXMuYW1vdW50O1xuICAgIH1cbiAgfVxuICBvblRvdWNoZG93bihlOiBUb3VjaEV2ZW50KSB7XG4gICAgaWYgKG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZihcIkFuZHJvaWRcIikgPj0gMCkgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHRoaXMuc3RhcnRQcmVzcyA9IGUudGFyZ2V0VG91Y2hlc1swXS5jbGllbnRYO1xuICAgIHRoaXMubGFzdFggPSB0aGlzLmFtb3VudDtcbiAgfVxuXG4gIG9uTW91c2Vtb3ZlKGU6IE1vdXNlRXZlbnQsIG1heFdpZHRoOiBudW1iZXIpIHtcbiAgICBpZiAoZS53aGljaCA9PT0gMSkge1xuICAgICAgY29uc3QgYW1vdW50ID0gdGhpcy5sYXN0WCAtICh0aGlzLnN0YXJ0UHJlc3MgLSBlLmNsaWVudFgpO1xuICAgICAgaWYgKGFtb3VudCA+IDAgfHwgYW1vdW50IDwgLShtYXhXaWR0aCAtIHRoaXMud2lkdGgpKSByZXR1cm47XG4gICAgICB0aGlzLmFtb3VudCA9IGFtb3VudDtcbiAgICB9XG4gIH1cbiAgb25Ub3VjaG1vdmUoZTogVG91Y2hFdmVudCwgbWF4V2lkdGg6IG51bWJlcikge1xuICAgIGlmIChuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoXCJBbmRyb2lkXCIpID49IDApIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBjb25zdCBhbW91bnQgPSB0aGlzLmxhc3RYIC0gKHRoaXMuc3RhcnRQcmVzcyAtIGUudGFyZ2V0VG91Y2hlc1swXS5jbGllbnRYKTtcbiAgICBpZiAoYW1vdW50ID4gMCB8fCBhbW91bnQgPCAtKG1heFdpZHRoIC0gdGhpcy53aWR0aCkpIHJldHVybjtcbiAgICB0aGlzLmFtb3VudCA9IGFtb3VudDtcbiAgfVxuXG4gIG9uTW91c2V1cChlOiBNb3VzZUV2ZW50LCBlbGVtOiBhbnkpIHtcbiAgICBpZiAoZS53aGljaCA9PT0gMSkge1xuICAgICAgdGhpcy5zdGFydFByZXNzID0gMDtcbiAgICAgIHRoaXMuc25hcChlbGVtKTtcbiAgICB9XG4gIH1cblxuICBvblRvdWNodXAoZTogVG91Y2hFdmVudCwgZWxlbTogYW55KSB7XG4gICAgaWYgKG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZihcIkFuZHJvaWRcIikgPj0gMCkgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHRoaXMuc3RhcnRQcmVzcyA9IDA7XG4gICAgdGhpcy5zbmFwKGVsZW0pO1xuICB9XG5cbiAgc25hcChlbGVtOiBhbnkpIHtcbiAgICBsZXQgY291bnRlciA9IDA7XG4gICAgbGV0IGxhc3RWYWwgPSAwO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5pdGVtcy5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgZWwgPSBlbGVtLmNoaWxkcmVuW2ldO1xuICAgICAgY29uc3Qgc3R5bGUgPSBlbC5jdXJyZW50U3R5bGUgfHwgd2luZG93LmdldENvbXB1dGVkU3R5bGUoZWwpO1xuICAgICAgY291bnRlciArPVxuICAgICAgICBlbC5vZmZzZXRXaWR0aCArXG4gICAgICAgIChwYXJzZUZsb2F0KHN0eWxlLm1hcmdpbkxlZnQpICsgcGFyc2VGbG9hdChzdHlsZS5tYXJnaW5SaWdodCkpO1xuICAgICAgaWYgKHRoaXMuYW1vdW50IDw9IGxhc3RWYWwgJiYgdGhpcy5hbW91bnQgPj0gLWNvdW50ZXIpIHtcbiAgICAgICAgdGhpcy5hbW91bnQgPSAtbGFzdFZhbDtcbiAgICAgICAgdGhpcy5jaGlsZEluZGV4ID0gaTtcbiAgICAgICAgdGhpcy5vblNlbGVjdGVkSXRlbS5lbWl0KHtcbiAgICAgICAgICBpdGVtOiB0aGlzLml0ZW1zW3RoaXMuY2hpbGRJbmRleF0sXG4gICAgICAgICAgaW5kZXg6IHRoaXMuY2hpbGRJbmRleCxcbiAgICAgICAgICBmaXJzdDogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGxhc3RWYWwgPSBjb3VudGVyO1xuICAgIH1cbiAgICByZXR1cm4gY291bnRlcjtcbiAgfVxuXG4gIHNjcm9sbChmb3J3YXJkOiBib29sZWFuLCBlbGVtOiBhbnksIHF0eSA9IDEpIHtcbiAgICB0aGlzLmNoaWxkSW5kZXggKz0gZm9yd2FyZCA/IHF0eSA6IC1xdHk7XG4gICAgdGhpcy5vblNlbGVjdGVkSXRlbS5lbWl0KHtcbiAgICAgIGl0ZW06IHRoaXMuaXRlbXNbdGhpcy5jaGlsZEluZGV4XSxcbiAgICAgIGluZGV4OiB0aGlzLmNoaWxkSW5kZXgsXG4gICAgICBmaXJzdDogZmFsc2VcbiAgICB9KTtcbiAgICB0aGlzLmFtb3VudCA9IC10aGlzLmNhbGNTY3JvbGwoZWxlbSk7XG4gIH1cblxuICBjYWxjU2Nyb2xsKGVsZW06IGFueSkge1xuICAgIGxldCBjb3VudGVyID0gMDtcbiAgICBmb3IgKGxldCBpID0gdGhpcy5jaGlsZEluZGV4IC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgIGNvbnN0IGVsID0gZWxlbS5jaGlsZHJlbltpXTtcbiAgICAgIGNvbnN0IHN0eWxlID0gZWwuY3VycmVudFN0eWxlIHx8IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGVsKTtcbiAgICAgIGNvdW50ZXIgKz1cbiAgICAgICAgZWwub2Zmc2V0V2lkdGggK1xuICAgICAgICAocGFyc2VGbG9hdChzdHlsZS5tYXJnaW5MZWZ0KSArIHBhcnNlRmxvYXQoc3R5bGUubWFyZ2luUmlnaHQpKTtcbiAgICB9XG4gICAgcmV0dXJuIGNvdW50ZXI7XG4gIH1cblxuICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKSB7XG4gICAgaWYgKFxuICAgICAgY2hhbmdlcy5pdGVtcyAmJlxuICAgICAgIWlzRXF1YWwoY2hhbmdlcy5pdGVtcy5wcmV2aW91c1ZhbHVlLCBjaGFuZ2VzLml0ZW1zLmN1cnJlbnRWYWx1ZSlcbiAgICApIHtcbiAgICAgIGlmIChjaGFuZ2VzLml0ZW1zLmZpcnN0Q2hhbmdlKSB7XG4gICAgICAgIHRoaXMub25TZWxlY3RlZEl0ZW0uZW1pdCh7XG4gICAgICAgICAgaXRlbTogdGhpcy5pdGVtc1t0aGlzLmNoaWxkSW5kZXhdLFxuICAgICAgICAgIGluZGV4OiB0aGlzLmNoaWxkSW5kZXgsXG4gICAgICAgICAgZmlyc3Q6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICB0aGlzLmFtb3VudCA9IDA7XG4gICAgfVxuICB9XG5cbiAgbmdBZnRlclZpZXdJbml0KCkge1xuICAgIHRoaXMuc3RhcnRQcmVzcyA9IDE7XG4gICAgdGhpcy5zY3JvbGwodHJ1ZSwgdGhpcy5saXN0Lm5hdGl2ZUVsZW1lbnQsIHRoaXMuc3RhcnRBdCk7XG4gICAgc2V0VGltZW91dCgoKSA9PiAodGhpcy5zdGFydFByZXNzID0gMCkpO1xuICB9XG59XG4iXX0=